#=======================================================
# Trigger Control Block
# Please add a comment line between registers
# Current script can't deal with empty lines, sorry
#=======================================================
#
# CONTROL BLOCK (WRITE)
#
# The desired bits are written to the IOC using the bo
# records, which FLNK to calc records used to shift
# the bit to its correct place. The result is used
# to actualy write out using the ao (asyn) record.
#
# All the ao (asyn) records for a given register
# appears one time for each bit, e.g. STATUS_FADC_SET
# and STATUS_CLCKDL_SET.
#
#=======================================================
# Status Register (BEGIN)
#-------------------------------------------------------
# FADC_CLR: FAST ADC Data Clock PLL Not Locked Latch
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):FADC_CLR
operation	record
DESC	Clear FADC Latch
FLNK	KLYS:$(AREA):$(LOCATION):FADC_CLR_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):FADC_CLR_MASK
DESC	Clear FADC Latch
INPA	KLYS:$(AREA):$(LOCATION):FADC_CLR
CALC	A << 10
FLNK	KLYS:$(AREA):$(LOCATION):STATUS_FADC_SET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):STATUS_FADC_SET
operation	write
task	0x01
address	0
size	1
DESC	MKSU Status (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))STATUS_FADC_SET
DOL	KLYS:$(AREA):$(LOCATION):FADC_CLR_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# CLCKDL_CLR: Sys Clock PLL Not Locked Latch
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):CLCKDL_CLR
operation	record
DESC	Clear Clck PLL Latch
FLNK	KLYS:$(AREA):$(LOCATION):CLCKDL_CLR_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):CLCKDL_CLR_MASK
DESC	Clear FADC Latch
INPA	KLYS:$(AREA):$(LOCATION):CLCKDL_CLR
CALC	A << 11
FLNK	KLYS:$(AREA):$(LOCATION):STATUS_CLCKDL_SET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):STATUS_CLCKDL_SET
operation	write
task	0x01
address	0
size	1
DESC	MKSU Status (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))STATUS_CLCKDL_SET
DOL	KLYS:$(AREA):$(LOCATION):CLCKDL_CLR_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# Status Register (END)
#-------------------------------------------------------
# Control Set Register (BEGIN)
#-------------------------------------------------------
# PERMIT_SET: Set the PERMIT bit (Bit 0)
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):PERMIT_SET
operation	record
DESC	Permit set
FLNK	KLYS:$(AREA):$(LOCATION):PERMIT_SET_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):PERMIT_SET_MASK
DESC	Clear FADC Latch
INPA	KLYS:$(AREA):$(LOCATION):PERMIT_SET
CALC	A
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_PERMIT_SET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):CTRL_PERMIT_SET
operation	write
task	0x01
address	1
size	1
DESC	MKSU Control (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL_PERMIT_SET
DOL	KLYS:$(AREA):$(LOCATION):PERMIT_SET_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# TREN_SET: Set Trigger Enable bit (Bit 1)
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):TREN_SET
operation	record
DESC	Trigger Enable (Set)
FLNK	KLYS:$(AREA):$(LOCATION):TREN_SET_MASK
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):TREN_SET_MASK
DESC	Triggen Enable (Set)
INPA	KLYS:$(AREA):$(LOCATION):TREN_SET
CALC	A << 1
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_TREN_SET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):CTRL_TREN_SET
operation	write
task	0x01
address	1
size	1
DESC	MKSU Control (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL_TREN_SET
DOL	KLYS:$(AREA):$(LOCATION):TREN_SET_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# CFGD_SET: Configured bit (Bit 2)
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):CFGD_SET
operation	record
DESC	Configured (Set)
FLNK	KLYS:$(AREA):$(LOCATION):CFGD_SET_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):CFGD_SET_MASK
DESC	Configured (Set)
INPA	KLYS:$(AREA):$(LOCATION):CFGD_SET
CALC	A << 2
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_CFGD_SET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):CTRL_CFGD_SET
operation	write
task	0x01
address	1
size	1
DESC	MKSU Control (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL_CFGD_SET
DOL	KLYS:$(AREA):$(LOCATION):CFGD_SET_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# WFTR_SET: Arm Waveform Trigger bit (Bit 3)
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):WFTR_SET
operation	record
DESC	Arm Waveform Trig (Set)
FLNK	KLYS:$(AREA):$(LOCATION):WFTR_SET_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):WFTR_SET_MASK
DESC	Arm Waveform Trig (Set)
INPA	KLYS:$(AREA):$(LOCATION):WFTR_SET
CALC	A << 3
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_WFTR_SET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):CTRL_WFTR_SET
operation	write
task	0x01
address	1
size	1
DESC	MKSU Control (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL_WFTR_SET
DOL	KLYS:$(AREA):$(LOCATION):WFTR_SET_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# AVTR_SET: Arm Average Trigger bit (Bit 4)
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):AVTR_SET
operation	record
DESC	Arm Average Trig (Set)
FLNK	KLYS:$(AREA):$(LOCATION):AVTR_SET_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):AVTR_SET_MASK
DESC	Arm Average Trig (Set)
INPA	KLYS:$(AREA):$(LOCATION):AVTR_SET
CALC	A << 4
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_AVTR_SET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):CTRL_AVTR_SET
operation	write
task	0x01
address	1
size	1
DESC	MKSU Control (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL_AVTR_SET
DOL	KLYS:$(AREA):$(LOCATION):AVTR_SET_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# Control Set Register (END)
#-------------------------------------------------------
# Control Reset Register (BEGIN)
#-------------------------------------------------------
# PERMIT_RSET: Reset the PERMIT bit (Bit 0)
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):PERMIT_RSET
operation	record
DESC	Permit set
FLNK	KLYS:$(AREA):$(LOCATION):PERMIT_RSET_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):PERMIT_RSET_MASK
DESC	Clear FADC Latch
INPA	KLYS:$(AREA):$(LOCATION):PERMIT_RSET
CALC	A
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_PERMIT_RSET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):CTRL_PERMIT_RSET
operation	write
task	0x01
address	2
size	1
DESC	MKSU Control (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL_PERMIT_RSET
DOL	KLYS:$(AREA):$(LOCATION):PERMIT_RSET_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# TREN_RSET: Reset Trigger Enable bit (Bit 1)
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):TREN_RSET
operation	record
DESC	Trigger Enable (Set)
FLNK	KLYS:$(AREA):$(LOCATION):TREN_RSET_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):TREN_RSET_MASK
DESC	Triggen Enable (Set)
INPA	KLYS:$(AREA):$(LOCATION):TREN_RSET
CALC	A << 1
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_TREN_RSET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):CTRL_TREN_RSET
operation	write
task	0x01
address	2
size	1
DESC	MKSU Control (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL_TREN_RSET
DOL	KLYS:$(AREA):$(LOCATION):TREN_RSET_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# CFGD_RSET: Reset Configured bit (Bit 2)
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):CFGD_RSET
operation	record
DESC	Configured (Set)
FLNK	KLYS:$(AREA):$(LOCATION):CFGD_RSET_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):CFGD_RSET_MASK
DESC	Configured (Set)
INPA	KLYS:$(AREA):$(LOCATION):CFGD_RSET
CALC	A << 2
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_CFGD_RSET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):CTRL_CFGD_RSET
operation	write
task	0x01
address	2
size	1
DESC	MKSU Control (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL_CFGD_RSET
DOL	KLYS:$(AREA):$(LOCATION):CFGD_RSET_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# WFTR_RSET: Reset Arm Waveform Trigger bit (Bit 3)
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):WFTR_RSET
operation	record
DESC	Arm Waveform Trig (Set)
FLNK	KLYS:$(AREA):$(LOCATION):WFTR_RSET_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):WFTR_RSET_MASK
DESC	Arm Waveform Trig (Set)
INPA	KLYS:$(AREA):$(LOCATION):WFTR_RSET
CALC	A << 3
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_WFTR_RSET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):CTRL_WFTR_RSET
operation	write
task	0x01
address	2
size	1
DESC	MKSU Control (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL_WFTR_RSET
DOL	KLYS:$(AREA):$(LOCATION):WFTR_RSET_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# AVTR_RSET: Reset Arm Average Trigger bit (Bit 4)
#-------------------------------------------------------
record	bo
name	KLYS:$(AREA):$(LOCATION):AVTR_RSET
operation	record
DESC	Arm Average Trig (Set)
FLNK	KLYS:$(AREA):$(LOCATION):AVTR_RSET_MASK
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):AVTR_RSET_MASK
DESC	Arm Average Trig (Set)
INPA	KLYS:$(AREA):$(LOCATION):AVTR_RSET
CALC	A << 4
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_AVTR_RSET
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):CTRL_AVTR_RSET
operation	write
task	0x01
address	2
size	1
DESC	MKSU Control (write)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL_AVTR_RSET
DOL	KLYS:$(AREA):$(LOCATION):AVTR_RSET_MASK
OMSL	closed_loop
PRIO	LOW
#-------------------------------------------------------
# Control Reset Register (END)
#-------------------------------------------------------
# Modulator State Register (BEGIN)
#-------------------------------------------------------
# MODSTATE_SET: Modulator State Set (Bits 0-3)
#-------------------------------------------------------
record	mbbo
name	KLYS:$(AREA):$(LOCATION):MODSTATE_SET
operation	write
task	0x01
address	3
size	1
DESC	Modulator State (Set)
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))MODSTATE_SET
ONVL	1
TWVL	2
THVL	3
FRVL	4
ONST	Maintenance
TWST	Offline
THST	Stand By
FRST	Accelerate
PRIO	LOW
#-------------------------------------------------------
# Modulator State Register (END)
#=======================================================
#
# CONTROL BLOCK (READ)
#
# The status register is read in the STATUS record,
# which FLNKs to calc records to extract individual
# bits, identified by the bi records
#
#=======================================================
# Status Register (BEGIN)
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):STATUS
operation	read
task	0x41
address	0
size	1
DESC	MKSU Status
DTYP	asynInt32
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))STATUS
FLNK	KLYS:$(AREA):$(LOCATION):PERMIT_MASK
SCAN	$(SCAN)
PRIO	LOW
#-------------------------------------------------------
# PERMIT: Permit (Bit 0)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):PERMIT_MASK
DESC	Permit Status
INPA	KLYS:$(AREA):$(LOCATION):STATUS
CALC	A & (1 << 0)
FLNK	KLYS:$(AREA):$(LOCATION):PERMIT
PRIO	LOW
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):PERMIT
operation	record
DESC	Permit Status
INP	KLYS:$(AREA):$(LOCATION):PERMIT_MASK
ZNAM	No Permit
ONAM	Permit
FLNK	KLYS:$(AREA):$(LOCATION):TREN_MASK
PRIO	LOW
#-------------------------------------------------------
# TREN: Trigger Enable (Bit 1)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):TREN_MASK
DESC	Trigger Enable Status
INPA	KLYS:$(AREA):$(LOCATION):STATUS
CALC	(A & (1 << 1)) >> 1
PRIO	LOW
FLNK	KLYS:$(AREA):$(LOCATION):TREN
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):TREN
operation	record
DESC	Trigger Enable Status
INP	KLYS:$(AREA):$(LOCATION):TREN_MASK
ZNAM	Not Enabled
ONAM	Enabled
FLNK	KLYS:$(AREA):$(LOCATION):CFGD_MASK
PRIO	LOW
#-------------------------------------------------------
# CFGD: Configured (Bit 2)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):CFGD_MASK
DESC	Configured Status
INPA	KLYS:$(AREA):$(LOCATION):STATUS
CALC	(A & (1 << 2)) >> 2
FLNK	KLYS:$(AREA):$(LOCATION):CFGD
PRIO	LOW
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):CFGD
operation	record
DESC	Configured Status
INP	KLYS:$(AREA):$(LOCATION):CFGD_MASK
ZNAM	Not Configured
ONAM	Configured
FLNK	KLYS:$(AREA):$(LOCATION):MOD_MASK
PRIO	LOW
#-------------------------------------------------------
# MOD: Modulator State (Bit 3, 4 & 5)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):MOD_MASK
DESC	Modulador State
INPA	KLYS:$(AREA):$(LOCATION):STATUS
CALC	(A & (7 << 3) >> 3)
FLNK	KLYS:$(AREA):$(LOCATION):MOD
PRIO	LOW
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):MOD
operation	record
DESC	Modulator State
INP	KLYS:$(AREA):$(LOCATION):MOD_MASK
FLNK	KLYS:$(AREA):$(LOCATION):RATE119_MASK
PRIO	LOW
#-------------------------------------------------------
# RATE1119: 119MHz or 125MHz Present (Bit 6)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):RATE119_MASK
DESC	119MHz Present
INPA	KLYS:$(AREA):$(LOCATION):STATUS
CALC	(A & (1 << 6)) >> 6
FLNK	KLYS:$(AREA):$(LOCATION):RATE119
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):RATE119
operation	record
DESC	119MHz Present
INP	KLYS:$(AREA):$(LOCATION):RATE119_MASK
ZNAM	125MHz
ONAM	119MHz
FLNK	KLYS:$(AREA):$(LOCATION):CLCKD_MASK
PRIO	LOW
#-------------------------------------------------------
# CLCKD: SysClock PLL Locked (Bit 7)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):CLCKD_MASK
DESC	Sys Clck PLL Lckd
INPA	KLYS:$(AREA):$(LOCATION):STATUS
CALC	(A & (1 << 7)) >> 7
FLNK	KLYS:$(AREA):$(LOCATION):CLCKD
PRIO	LOW
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):CLCKD
operation	record
DESC	Sys Clck PLL Lckd
INP	KLYS:$(AREA):$(LOCATION):CLCKD_MASK
ZNAM	Not Locked
ONAM	Locked
FLNK	KLYS:$(AREA):$(LOCATION):LOCAL_MASK
#-------------------------------------------------------
# LOCAL: Local Mode (Bit 8)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):LOCAL_MASK
DESC	Local Mode
INPA	KLYS:$(AREA):$(LOCATION):STATUS
CALC	(A & (1 << 8)) >> 8
FLNK	KLYS:$(AREA):$(LOCATION):LOCAL
PRIO	LOW
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):LOCAL
operation	record
DESC	Local Mode
INP	KLYS:$(AREA):$(LOCATION):LOCAL_MASK
ZNAM	Remote
ONAM	Local
FLNK	KLYS:$(AREA):$(LOCATION):FCLCKD_MASK
PRIO	LOW
#-------------------------------------------------------
# FCLCKD: FAST ADC Data Clock PLL Locked (Bit 9)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):FCLCKD_MASK
DESC	FADC Clck PLL Lckd
INPA	KLYS:$(AREA):$(LOCATION):STATUS
CALC	(A & (1 << 9)) >> 9
FLNK	KLYS:$(AREA):$(LOCATION):FCLCKD
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):FCLCKD
operation	record
DESC	FADC Clck PLL Lckd
INP	KLYS:$(AREA):$(LOCATION):FCLCKD_MASK
ZNAM	Not Locked
ONAM	Locked
FLNK	KLYS:$(AREA):$(LOCATION):CLCKDL_MASK
PRIO	LOW
#-------------------------------------------------------
# CLCKDL: Sys Clock PLL Not Locked Latch (Bit 10)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):CLCKDL_MASK
DESC	Clck PLL Not Lckd Latch
INPA	KLYS:$(AREA):$(LOCATION):STATUS
CALC	(A & (1 << 10)) >> 10
FLNK	KLYS:$(AREA):$(LOCATION):CLCKDL
PRIO	LOW
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):CLCKDL
operation	record
DESC	Clkc PLL Not Lckd Latch
INP	KLYS:$(AREA):$(LOCATION):CLCKDL_MASK
ZNAM	Not Latch
ONAM	Latch
PRIO	LOW
#-------------------------------------------------------
# FCLCKDL: FAST ADC Data Clock PLL Not Locked Latch (Bit 11)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):FCLCKDL_MASK
DESC	FADC PLL Not Lckd Latch
INPA	KLYS:$(AREA):$(LOCATION):STATUS
CALC	(A & (1 << 10)) >> 10
FLNK	KLYS:$(AREA):$(LOCATION):FCLCKDL
PRIO	LOW
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):FCLCKDL
operation	record
DESC	Clkc PLL Locked Latch
INP	KLYS:$(AREA):$(LOCATION):FCLCKDL_MASK
ZNAM	Not Latch
ONAM	Latch
PRIO	LOW
#-------------------------------------------------------
# Status Register (END)
#=======================================================
# Control Register (BEGIN)
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):CTRL
operation	read
task	0x41
address	1
size	1
DESC	MKSU Control
DTYP	asynInt32
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))CTRL
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_WFTR_MASK
SCAN	$(SCAN)
PRIO	LOW
#-------------------------------------------------------
# WFTR: Arm Waveform Trigger (Bit 3)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):CTRL_WFTR_MASK
DESC	Arm Waveform Trigger
INPA	KLYS:$(AREA):$(LOCATION):CTRL
CALC	(A & (1 << 3)) >> 3
FLNK	KLYS:$(AREA):$(LOCATION):WFTR
PRIO	LOW
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):WFTR
operation	record
DESC	Arm Waveform Trigger
INP	KLYS:$(AREA):$(LOCATION):CTRL_WFTR_MASK
ZNAM	No
ONAM	Yes
FLNK	KLYS:$(AREA):$(LOCATION):CTRL_AVTR_MASK
PRIO	LOW
#-------------------------------------------------------
# AVTR: Arm Average Trigger (Bit 4)
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):CTRL_AVTR_MASK
DESC	Arm Waveform Trigger
INPA	KLYS:$(AREA):$(LOCATION):CTRL
CALC	(A & (1 << 4)) >> 4
FLNK	KLYS:$(AREA):$(LOCATION):AVTR
PRIO	LOW
#-------------------------------------------------------
record	bi
name	KLYS:$(AREA):$(LOCATION):AVTR
operation	record
DESC	Arm Waveform Trigger
INP	KLYS:$(AREA):$(LOCATION):CTRL_AVTR_MASK
ZNAM	No
ONAM	Yes
PRIO	LOW
#-------------------------------------------------------
# Control Register (END)
#-------------------------------------------------------
# Modulator State Register (BEGIN)
#-------------------------------------------------------
# MODSTATE: Modulator State Set (Bits 0-3)
#-------------------------------------------------------
record	mbbi
name	KLYS:$(AREA):$(LOCATION):MODSTATE
operation	write
task	0x41
address	2
size	1
DESC	Modulator State (Read)
DTYP	asynInt32
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))MODSTATE
ONVL	1
TWVL	2
THVL	3
FRVL	4
ONST	Maintenance
TWST	Offline
THST	Stand By
FRST	Accelerate
PRIO	LOW
#-------------------------------------------------------
# Modulator State Register (END)
#=======================================================
# SLOW MONITOR ADC (WRITE)
#=======================================================
#=======================================================
# SLOW MONITOR ADC (READ)
#=======================================================
#=======================================================
# VOLTAGE MONITOR (READ)
#=======================================================
#=======================================================
# TRIGGER CONTROL BLOCK (WRITE)
#=======================================================
record	ao
name	KLYS:$(AREA):$(LOCATION):WF_TDLY_DES
operation	write
task	0x05
address	0
size	1
DESC	Waveform des trigger delay
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))WF_TDLY_DES
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):TDLY_DES
operation	write
task	0x05
address	1
size	1
DESC	Remote mod des trig delay
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TDLY_DES
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):TDLY_RP_DES
operation	write
task	0x05
address	2
size	1
DESC	Rear panel des trig delay
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TDLY_RP_DES
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):TWTH_RP_DES
operation	write
task	0x05
address	3
size	1
DESC	Rear panel des trig width
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TWTH_RP_DES
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):TDLY_FP_DES
operation	write
task	0x05
address	4
size	1
DESC	Front panel des trig delay
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TDLY_FP_DES
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):TWTH_FP_DES
operation	write
task	0x05
address	5
size	1
DESC	Front panel des trig width
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TWTH_FP_DES
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):TCNT_IN_DES
operation	write
task	0x05
address	8
size	1
DESC	Input trigger des rate cnt
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TCNT_IN_DES
EGU	1KHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	ao
name	KLYS:$(AREA):$(LOCATION):TCNT_OUT_DES
operation	write
task	0x05
address	9
size	1
DESC	Output trigger des rate cnt
DTYP	asynInt32
OUT	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TCNT_OUT_DES
EGU	1KHz Ticks
PRIO	LOW
#=======================================================
# TRIGGER CONTROL BLOCK (READ)
#=======================================================
record	ai
name	KLYS:$(AREA):$(LOCATION):WF_TDLY
operation	read 
task	0x45
address	0
size	1
DESC	Waveguide trig delay
DTYP	asynInt32
FLNK	KLYS:$(AREA):$(LOCATION):WF_TDLY_NS
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))WF_TDLY
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):WF_TDLY_NS
DESC	Waveguide trig delay (NS)
INPA	KLYS:$(AREA):$(LOCATION):WF_TDLY
EGU	ns
CALC	A/0.119
PRIO	LOW
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):TDLY
operation	read 
task	0x45
address	1
size	1
DESC	Remote mod trig delay
DTYP	asynInt32
FLNK	KLYS:$(AREA):$(LOCATION):TDLY_NS
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TDLY
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):TDLY_NS
DESC	Remote mod trig delay (NS)
INPA	KLYS:$(AREA):$(LOCATION):TDLY
EGU	ns
CALC	A/0.119
PRIO	LOW
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):TDLY_RP
operation	read 
task	0x45
address	2
size	1
DESC	Rear panel trig delay
DTYP	asynInt32
FLNK	KLYS:$(AREA):$(LOCATION):TDLY_RP_NS
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TDLY_RP
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):TDLY_RP_NS
DESC	Rear panel trig delay (NS)
INPA	KLYS:$(AREA):$(LOCATION):TDLY_RP
EGU	ns
CALC	A/0.119
PRIO	LOW
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):TWTH_RP
operation	read 
task	0x45
address	3
size	1
DESC	Rear panel trig width
DTYP	asynInt32
FLNK	KLYS:$(AREA):$(LOCATION):TWTH_RP_NS
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TWTH_RP
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):TWTH_RP_NS
DESC	Rear panel trig width (NS)
INPA	KLYS:$(AREA):$(LOCATION):TWTH_RP
EGU	ns
CALC	A/0.119
PRIO	LOW
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):TDLY_FP
operation	read 
task	0x45
address	4
size	1
DESC	Front panel trig delay
DTYP	asynInt32
FLNK	KLYS:$(AREA):$(LOCATION):TDLY_FP_NS
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TDLY_FP
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):TDLY_FP_NS
DESC	Front panel trig delay (NS)
INPA	KLYS:$(AREA):$(LOCATION):TDLY_FP
EGU	ns
CALC	A/0.119
PRIO	LOW
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):TWTH_FP
operation	read 
task	0x45
address	5
size	1
DESC	Front panel trig width
DTYP	asynInt32
FLNK	KLYS:$(AREA):$(LOCATION):TWTH_FP_NS
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TWTH_FP
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):TWTH_FP_NS
DESC	Front panel trig width (NS)
INPA	KLYS:$(AREA):$(LOCATION):TWTH_FP
EGU	ns
CALC	A/0.119
PRIO	LOW
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):TDLY_LOC
operation	read 
task	0x45
address	6
size	1
DESC	Local trigger delay
DTYP	asynInt32
FLNK	KLYS:$(AREA):$(LOCATION):TDLY_LOC_NS
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TDLY_LOC
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):TDLY_LOC_NS
DESC	Local trigger delay (NS)
INPA	KLYS:$(AREA):$(LOCATION):TDLY_LOC
EGU	ns
CALC	A/0.119
PRIO	LOW
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):TDLY_ACT
operation	read 
task	0x45
address	7
size	1
DESC	Actual trigger delay
DTYP	asynInt32
#FLNK	KLYS:$(AREA):$(LOCATION):TDLY_ACT_NS
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TDLY_ACT
EGU	119MHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	calc
operation	record
name	KLYS:$(AREA):$(LOCATION):TDLY_ACT_NS
DESC	Actual trigger delay (NS)
INPA	KLYS:$(AREA):$(LOCATION):TDLY_ACT
EGU	ns
CALC	A/0.119
PRIO	LOW
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):TCNT_IN
operation	read 
task	0x45
address	8
size	1
DESC	Input trigger rate count
DTYP	asynInt32
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TCNT_IN
EGU	1KHz Ticks
PRIO	LOW
#-------------------------------------------------------
record	ai
name	KLYS:$(AREA):$(LOCATION):TCNT_OUT
operation	read 
task	0x45
address	8
size	1
DESC	Input trigger rate count
DTYP	asynInt32
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))TCNT_IN
EGU	1KHz Ticks
PRIO	LOW
#=======================================================
# SYSTEM INFO BLOCK (READ)
#=======================================================
record	waveform
name	KLYS:$(AREA):$(LOCATION):SYS_VERSION
operation	read
task	0x64
address	0
size	8
DESC	Firmware version
DTYP	asynInt8Array
FTVL	UCHAR
NELM	8
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))SYS_VERSION
PRIO	LOW
#-------------------------------------------------------
record	waveform
name	KLYS:$(AREA):$(LOCATION):SYS_ID
operation	read
task	0x64
address	4
size	6
DESC	System ID
DTYP	asynInt8Array
FTVL	UCHAR
NELM	6
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))SYS_ID
PRIO	LOW
#-------------------------------------------------------
record	waveform
name	KLYS:$(AREA):$(LOCATION):SYS_SUB_TYPE
operation	read
task	0x64
address	7
size	4
DESC	System sub type
DTYP	asynInt8Array
FTVL	UCHAR
NELM	4
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))SYS_SUB_TYPE
PRIO	LOW
#-------------------------------------------------------
record	waveform
name	KLYS:$(AREA):$(LOCATION):SYS_DATE
operation	read
task	0x64
address	9
size	8
DESC	System date
DTYP	asynInt8Array
FTVL	UCHAR
NELM	8
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))SYS_DATE
PRIO	LOW
#-------------------------------------------------------
record	waveform
name	KLYS:$(AREA):$(LOCATION):RF_DRV_TBL_READ
operation	read
task	0x67
address	0
size	256
DESC	RF drive lookup table
DTYP	asynInt16Array
FTVL	SHORT
NELM	256
SCAN	$(SCAN)
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))RF_DRV_TBL_READ
PRIO	LOW
#-------------------------------------------------------
record	waveform
name	KLYS:$(AREA):$(LOCATION):RF_DRV_TBL_WRITE
operation	write
task	0x27
address	0
size	256
DESC	RF drive lookup table
DTYP	asynInt16Array
FTVL	SHORT
NELM	256
INP	@asyn($(PORT) $(CHANNEL) $(TIMEOUT))RF_DRV_TBL_WRITE
PRIO	LOW
